```

Our market & currency investments gains calculations only consider the endpoints of the investment period (purchase/opening and sale/closing). When making the calculation, it is implicitly treated as though all the market gains happen at once, and then all the currency gains happen at once, in sequence. If we create a report where there's a currency rate change, followed by a market rate change, we get potentially unintuitive results. A potentially deeper problem is that if we split this up into two reports, one which has the currency rate change, and a later one that has the market rate change, the split up reports reflect the expected results. So just by breaking up the report into two periods we actually get different values of market and currency gains, even though the two reports contain exactly the same accounting information as the original report.

Essentially the computed values of market and currency would not match up with a running totals of their balances. We currently don't have any generic notion of "running totals" in the system but this is basically what's being simulated by splitting the original report into two reports.

There are 6 examples, forex-request2.xml which shows a market rate change followed by a currency rate change, and forex-request2a and 2b xmls which split these changes into different reporting periods. Everything is fine here because this sequencing of rate-change events matches the implicit sequencing used in the calculation. Then there is forex-request3.xml which shows a currency rate change followed by a market rate change. Because only the endpoints are taken into account, the results match those from forex-request2.xml, 1000 market gains, 2000 forex gains (potentially unintiutive, and would not match a running totals). forex-request3a.xml and forex-request3b.xml split the currency rate change and market rate change events into two reports. 3a shows a forex gains of 1000, and 3b shows a market gains of 2000. So just by splitting forex-request3.xml into two reports, we get different values of market & currency gains. This defies a certain expectation of monotonicity, i.e. that if we combine two reports into one, they still represent essentially the same set of facts. There are cases where non-monotonicity is expected and even required, for example the distinction between historical and current, but it doesn't seem that choice of reporting periods should have any impact on what component of investment gains is interpreted as being market gains vs. currency gains.

I've added a spreadsheet ForexIssue.xlsx to the docs under the investment directory which matches the contents of the forex-request xmls
```
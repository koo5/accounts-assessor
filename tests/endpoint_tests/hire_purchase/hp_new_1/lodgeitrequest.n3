@prefix : <https://rdf.lodgeit.net.au/v1#> .
@prefix depr: <https://rdf.lodgeit.net.au/v1/calcs/depr#> .
@prefix depr_ui: <https://rdf.lodgeit.net.au/v1/calcs/depr/ui#> .
@prefix excel: <https://rdf.lodgeit.net.au/v1/excel#> .
@prefix hp: <https://rdf.lodgeit.net.au/v1/calcs/hp#> .
@prefix hp_ui: <https://rdf.lodgeit.net.au/v1/calcs/hp/ui#> .
@prefix ic: <https://rdf.lodgeit.net.au/v1/calcs/ic#> .
@prefix ic_ui: <https://rdf.lodgeit.net.au/v1/calcs/ic/ui#> .
@prefix l: <https://rdf.lodgeit.net.au/v1/request#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

:this
    rdfs:comment """\r
unfinished work on introducing namespacing. This should help with ordering the output of rdf_cleanup2.py and similar reasonably, and in keeping identifiers short\r
\r
prefixes:\r
	excel: generic excel schema-directed ui stuff\r
\r
	hp: hirepurchase\r
	depr: depreciation\r
	ic: investment calculator\r
""" .

depr:asset_disposal
    a depr:depreciation_event_type .

depr:depreciation_between_two_dates
    a depr:depreciation_query_type .

depr:depreciation_event_has_type
    rdfs:range depr:depreciation_event_type .

depr:depreciation_pool_from_start
    a depr:depreciation_query_type .

depr:depreciation_query_has_type
    rdfs:range depr:depreciation_query_type .

depr:profit_and_loss
    a depr:depreciation_query_type .

depr:transfer_asset_to_pool
    a depr:depreciation_event_type .

depr:written_down_value
    a depr:depreciation_query_type .

depr_ui:depreciation_assets
    excel:cardinality excel:multi ;
    excel:class depr:depreciation_asset ;
    excel:fields (
         [
                excel:property depr:id
         ]
         [
                excel:property depr:start_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property depr:cost ;
                excel:type xsd:decimal
         ]
         [
                excel:property depr:effective_life_years ;
                excel:type xsd:integer
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "1"
     ] ;
    excel:title "depreciation_assets" .

depr_ui:depreciation_calculator_sheets
    excel:is_multi false ;
    excel:sheets (
         [
                excel:example_doc depr_ui:depreciation_example_queries ;
                excel:name_prefix "depreciation_queries" ;
                excel:root depr_ui:depreciation_queries
         ]
         [
                excel:example_doc depr_ui:depreciation_example_events ;
                excel:name_prefix "depreciation_events" ;
                excel:root depr_ui:depreciation_events
         ]
         [
                excel:example_doc depr_ui:depreciation_example_assets ;
                excel:name_prefix "depreciation_assets" ;
                excel:root depr_ui:depreciation_assets
         ] ) .

depr_ui:depreciation_events
    excel:cardinality excel:multi ;
    excel:class depr:depreciation_event ;
    excel:fields (
         [
                excel:property depr:depreciation_event_has_type ;
                excel:type excel:uri
         ]
         [
                excel:property depr:depreciation_event_asset
         ]
         [
                excel:property depr:depreciation_event_pool
         ]
         [
                excel:property depr:depreciation_event_date ;
                excel:type xsd:dateTime
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "1"
     ] ;
    excel:title "depreciation_events" .

depr_ui:depreciation_example_assets
    rdf:value (
         [
                a depr:depreciation_asset ;
                depr:cost [
                        a rdf:value ;
                        rdf:value 1000
                 ] ;
                depr:effective_life_years [
                        a rdf:value ;
                        rdf:value 5
                 ] ;
                depr:id [
                        a rdf:value ;
                        rdf:value "car123"^^xsd:string
                 ] ;
                depr:start_date [
                        a rdf:value ;
                        rdf:value "2017-05-01T00:00:00"^^xsd:dateTime
                 ]
         ]
         [
                a depr:depreciation_asset ;
                depr:cost [
                        a rdf:value ;
                        rdf:value 2000
                 ] ;
                depr:effective_life_years [
                        a rdf:value ;
                        rdf:value 8
                 ] ;
                depr:id [
                        a rdf:value ;
                        rdf:value "car456"^^xsd:string
                 ] ;
                depr:start_date [
                        a rdf:value ;
                        rdf:value "2015-03-16T00:00:00"^^xsd:dateTime
                 ]
         ] ) .

depr_ui:depreciation_example_events
    rdf:value (
         [
                a depr:depreciation_event ;
                depr:depreciation_event_asset [
                        a rdf:value ;
                        rdf:value "car123"^^xsd:string
                 ] ;
                depr:depreciation_event_date [
                        a rdf:value ;
                        rdf:value "2017-06-01T00:00:00"^^xsd:dateTime
                 ] ;
                depr:depreciation_event_has_type [
                        a rdf:value ;
                        rdf:value depr:transfer_asset_to_pool
                 ] ;
                depr:depreciation_event_pool [
                        a rdf:value ;
                        rdf:value "general_pool"^^xsd:string
                 ]
         ]
         [
                a depr:depreciation_event ;
                depr:depreciation_event_asset [
                        a rdf:value ;
                        rdf:value "car456"^^xsd:string
                 ] ;
                depr:depreciation_event_date [
                        a rdf:value ;
                        rdf:value "2017-08-01T00:00:00"^^xsd:dateTime
                 ] ;
                depr:depreciation_event_has_type [
                        a rdf:value ;
                        rdf:value depr:transfer_asset_to_pool
                 ] ;
                depr:depreciation_event_pool [
                        a rdf:value ;
                        rdf:value "general_pool"^^xsd:string
                 ]
         ]
         [
                a depr:depreciation_event ;
                depr:depreciation_event_asset [
                        a rdf:value ;
                        rdf:value "car123"^^xsd:string
                 ] ;
                depr:depreciation_event_date [
                        a rdf:value ;
                        rdf:value "2021-06-01T00:00:00"^^xsd:dateTime
                 ] ;
                depr:depreciation_event_has_type [
                        a rdf:value ;
                        rdf:value depr:asset_disposal
                 ]
         ]
         [
                a depr:depreciation_event ;
                depr:depreciation_event_asset [
                        a rdf:value ;
                        rdf:value "car456"^^xsd:string
                 ] ;
                depr:depreciation_event_date [
                        a rdf:value ;
                        rdf:value "2020-07-31T00:00:00"^^xsd:dateTime
                 ] ;
                depr:depreciation_event_has_type [
                        a rdf:value ;
                        rdf:value depr:asset_disposal
                 ]
         ] ) .

depr_ui:depreciation_example_queries
    rdf:value (
         [
                a depr:depreciation_query ;
                depr:depreciation_query_has_type [
                        a rdf:value ;
                        rdf:value depr:depreciation_pool_from_start
                 ] ;
                depr:depreciation_query_method [
                        a rdf:value ;
                        rdf:value "diminishing_value"^^xsd:string
                 ] ;
                depr:depreciation_query_pool [
                        a rdf:value ;
                        rdf:value "general_pool"^^xsd:string
                 ] ;
                depr:depreciation_query_to_date [
                        a rdf:value ;
                        rdf:value "2019-02-02T00:00:00"^^xsd:dateTime
                 ]
         ]
         [
                a depr:depreciation_query ;
                depr:depreciation_query_asset_id [
                        a rdf:value ;
                        rdf:value "car456"^^xsd:string
                 ] ;
                depr:depreciation_query_from_date [
                        a rdf:value ;
                        rdf:value "2017-06-01T00:00:00"^^xsd:dateTime
                 ] ;
                depr:depreciation_query_has_type [
                        a rdf:value ;
                        rdf:value depr:depreciation_between_two_dates
                 ] ;
                depr:depreciation_query_method [
                        a rdf:value ;
                        rdf:value "diminishing_value"^^xsd:string
                 ] ;
                depr:depreciation_query_to_date [
                        a rdf:value ;
                        rdf:value "2019-02-02T00:00:00"^^xsd:dateTime
                 ]
         ]
         [
                a depr:depreciation_query ;
                depr:depreciation_query_asset_id [
                        a rdf:value ;
                        rdf:value "car123"^^xsd:string
                 ] ;
                depr:depreciation_query_has_type [
                        a rdf:value ;
                        rdf:value depr:written_down_value
                 ] ;
                depr:depreciation_query_method [
                        a rdf:value ;
                        rdf:value "diminishing_value"^^xsd:string
                 ] ;
                depr:depreciation_query_written_down_date [
                        a rdf:value ;
                        rdf:value "2017-06-01T00:00:00"^^xsd:dateTime
                 ]
         ]
         [
                a depr:depreciation_query ;
                depr:depreciation_query_asset_id [
                        a rdf:value ;
                        rdf:value "car123"^^xsd:string
                 ] ;
                depr:depreciation_query_has_type [
                        a rdf:value ;
                        rdf:value depr:profit_and_loss
                 ] ;
                depr:depreciation_query_method [
                        a rdf:value ;
                        rdf:value "diminishing_value"^^xsd:string
                 ] ;
                depr:depreciation_query_termination_date [
                        a rdf:value ;
                        rdf:value "2019-07-07T00:00:00"^^xsd:dateTime
                 ] ;
                depr:depreciation_query_termination_value [
                        a rdf:value ;
                        rdf:value 500
                 ]
         ] ) .

depr_ui:depreciation_queries
    excel:cardinality excel:multi ;
    excel:class depr:depreciation_query ;
    excel:fields (
         [
                excel:property depr:depreciation_query_has_type ;
                excel:type excel:uri
         ]
         [
                excel:property depr:depreciation_query_asset_id
         ]
         [
                excel:property depr:depreciation_query_pool
         ]
         [
                excel:property depr:depreciation_query_from_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property depr:depreciation_query_to_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property depr:depreciation_query_written_down_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property depr:depreciation_query_method
         ]
         [
                excel:property depr:depreciation_query_termination_value ;
                excel:type xsd:decimal
         ]
         [
                excel:property depr:depreciation_query_termination_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property depr:depreciation_query_total_depreciation ;
                excel:type xsd:decimal
         ]
         [
                excel:property depr:depreciation_query_depreciation_value ;
                excel:type xsd:decimal
         ]
         [
                excel:property depr:depreciation_query_written_down_value ;
                excel:type xsd:decimal
         ]
         [
                excel:property depr:depreciation_query_profit_and_loss ;
                excel:type xsd:decimal
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "1"
     ] ;
    excel:title "depreciation_queries" .

hp:hp_contract_has_payment_type
    rdfs:range hp:hp_contract_payment_type .

hp:hp_contract_payment_type_advance
    a hp:hp_contract_payment_type ;
    rdfs:label "advance" .

hp_ui:hirepurchase_calculator_sheets
    excel:is_multi true ;
    excel:sheets (
         [
                excel:example_doc [
                        hp:begin_date [
                                rdf:value "2019-10-10T00:00:00"^^xsd:dateTime
                         ] ;
                        hp:hp_contract [
                                a hp:hp_contract ;
                                hp:cash_price [
                                        rdf:value "321321.27"
                                 ] ;
                                hp:contract_number [
                                        rdf:value "xxxx"
                                 ] ;
                                hp:currency [
                                        rdf:value "AUD"
                                 ] ;
                                hp:hp_contract_has_payment_type [
                                        rdf:value hp:hp_contract_payment_type_advance
                                 ] ;
                                hp:hp_installments [
                                        rdf:value ()
                                 ] ;
                                hp:interest_rate [
                                        rdf:value "5"
                                 ] ;
                                hp:number_of_installments [
                                        rdf:value 30
                                 ]
                         ]
                 ] ;
                excel:name_prefix "HP" ;
                excel:root hp_ui:hp_calculator_query
         ] ) .

hp_ui:hp_calculator_query
    excel:cardinality excel:single ;
    excel:class hp:hp_calculator_query ;
    excel:fields (
         [
                excel:comment "ignored for Investment Calculator" ;
                excel:property hp:begin_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:comment "ignored for Investment Calculator" ;
                excel:property hp:end_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property hp:hp_contract ;
                excel:template hp_ui:hp_contract
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "1"
     ] ;
    excel:title "Standalone Calculator Query Parameters" .

hp_ui:hp_contract
    excel:cardinality excel:single ;
    excel:class hp:hp_contract ;
    excel:fields (
         [
                excel:property hp:contract_number
         ]
         [
                excel:property hp:currency
         ]
         [
                excel:property hp:cash_price ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:interest_rate ;
                excel:type xsd:decimal
         ]
         [
                excel:note "dunno what type here" ;
                excel:property hp:interest_period
         ]
         [
                excel:note "dunno what type here" ;
                excel:property hp:repayment_period
         ]
         [
                excel:property hp:number_of_installments ;
                excel:type xsd:integer
         ]
         [
                excel:property hp:repayment_amount ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:total_payments ;
                excel:type xsd:integer
         ]
         [
                excel:property hp:total_interest ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:repayment_balance ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:hp_contract_has_payment_type ;
                excel:type excel:uri
         ]
         [
                excel:property hp:hp_installments ;
                excel:template hp_ui:hp_installments
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "5"
     ] ;
    excel:title "Hirepurchase Contract" .

hp_ui:hp_installments
    excel:cardinality excel:multi ;
    excel:class hp:hp_installment ;
    excel:fields (
         [
                excel:property hp:installment_number ;
                excel:type xsd:integer
         ]
         [
                excel:property hp:opening_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property hp:opening_balance ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:interest_amount ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:installment_amount ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:closing_date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property hp:closing_balance ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:total_repayments_through_period ;
                excel:type xsd:decimal
         ]
         [
                excel:property hp:total_interest_payments_through_period ;
                excel:type xsd:decimal
         ] ) ;
    excel:position [
            excel:col "E" ;
            excel:row "20"
     ] ;
    excel:title "Installments" .

ic_ui:account_roles
    excel:cardinality excel:multi ;
    excel:class ic:account_role ;
    excel:fields (
         [
                excel:property ic:id
         ]
         [
                excel:property ic:role
         ] ) .

ic_ui:account_taxonomies
    excel:cardinality excel:multi ;
    excel:class ic:account_taxonomy ;
    excel:fields (
         [
                excel:property ic:url ;
                excel:type xsd:string
         ] ) .

ic_ui:additional_files
    excel:cardinality excel:multi ;
    excel:class ic:additional_file ;
    excel:fields (
         [
                excel:property ic:url
         ] ) .

ic_ui:gl
    excel:cardinality excel:single ;
    excel:class ic:gl ;
    excel:fields (
         [
                excel:property ic:default_currency ;
                excel:type xsd:string
         ]
         [
                excel:property ic:items ;
                excel:template ic_ui:gl_entries_template
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "1"
     ] ;
    excel:title "GL input" .

ic_ui:gl_entries_template
    excel:cardinality excel:multi ;
    excel:class ic:gl_entry ;
    excel:fields (
         [
                excel:property ic:date ;
                excel:type xsd:dateTime
         ]
         [
                excel:property ic:account ;
                excel:type xsd:string
         ]
         [
                excel:property ic:description ;
                excel:type xsd:string
         ]
         [
                excel:property ic:debit ;
                excel:type xsd:string
         ]
         [
                excel:property ic:credit ;
                excel:type xsd:string
         ] ) ;
    excel:position [
            excel:col "A" ;
            excel:row "4"
     ] ;
    excel:title "entries" .

ic_ui:investment_calculator_sheets
    excel:is_multi false ;
    excel:sheets (
         [		% this seems like it would only be used for an example right
                excel:example_doc [
                        ic:default_currency [
                                rdf:value "AUD"
                         ] ;
                        ic:items [
                                rdf:value (
                                     [
                                            ic:account [
                                                    rdf:value "Assets"
                                             ] ;
                                            ic:date [
                                                    rdf:value "2019-10-10T00:00:00"^^xsd:dateTime
                                             ] ;
                                            ic:debit [
                                                    rdf:value "USD 500"
                                             ]
                                     ]
                                     [
                                            ic:account [
                                                    rdf:value "Revenue"
                                             ] ;
                                            ic:credit [
                                                    rdf:value "600"
                                             ] ;
                                            ic:date [
                                                    rdf:value "2019-10-10T00:00:00"^^xsd:dateTime
                                             ]
                                     ]
                                     [
                                            ic:account [
                                                    rdf:value "CurrencyMovement"
                                             ] ;
                                            ic:credit [
                                                    rdf:value "500 USD"
                                             ] ;
                                            ic:date [
                                                    rdf:value "2019-10-10T00:00:00"^^xsd:dateTime
                                             ] ;
                                            ic:debit [
                                                    rdf:value "600 AUD"
                                             ]
                                     ] )
                         ]
                 ] ;
                excel:name_prefix "GL_input" ;
                excel:optional true ;
                excel:root ic_ui:gl
         ]
         [
                excel:example_doc [
                        rdf:value ()
                 ] ;
                excel:optional true ;
                excel:root ic_ui:account_taxonomies
         ]
         [
                excel:example_doc [
                        rdf:value ()
                 ] ;
                excel:optional true ;
                excel:root ic_ui:account_roles
         ]
         [
                excel:example_doc [
                        rdf:value ()
                 ] ;
                excel:optional true ;
                excel:root ic_ui:additional_files
         ] ) .

excel:is_multi
    rdfs:comment "are multiple instances allowed in one workbook?" .



l:request
    hp_ui:hp_calculator_query [

/* err it either uses the rdf:type or idk, lemme check, it just finds all/any of these objects based on something
	ok so really hypothetically i could just add all the triples found by CHR to the doc (as long as they don't contain vars)
	and the excel plugin would already have enough to figure out what to display from that? yea

	ic, alright i didn't realize how much was being handled client-side here

        public void DisplayResponse(StreamReader data, bool inPlace)
        {
            LoadRdf(data);
            foreach (var triple in _g.GetTriplesWithPredicate(u("excel:has_sheet_name")))
            {
                var doc = triple.Subject;
                string sheet_name = triple.Object.AsValuedNode().AsString();
                if (inPlace)
                    _sheet = SheetByName(sheet_name);
                else
                    _sheet = NewUniqueNamedWorksheet(sheet_name);
                var template = GetObject(doc, "excel:template");
                WriteData(template, doc);
                _sheet.Columns.AutoFit();
            }
        }

HP especially has two menu items in the plugin, "in-place" and not-in-place (where to display results)
err both HP and depr more or less do

wrt rdf:value, does doc_to_rdf / vice-versa convert that to "regular values" or no
yeah no
the plugin generates / resolves that 

ok ill have to resolve that server-side also before passing the triples to chr

well it kinda has two functions now, the second is that a list is wrapped in an object, so that i can attach properties to the object, ie, a sheet can have root template with a list, so sheet_name and template have to be attached somewhere, and if i attach them directly to the list, then it screws up pretty printing n3 etc, iow it's just unexpected to have additional relations on a rdf list
but the main reason is that it's a nicety to the prolog side, since we need to have literals etc wrapped in a bnode to be able to do formula explaining etc, so, our reasoning should be expressed abstractly over those bnodes, to be able to do output for the explainer
or that was the idea, idk how the chr stuff is set up wrt handling that
the chr could hypothetically handle it but the (list + hp) rules aren't currently structured that way, not sure if they
should be; seems like that stuff for the explainer should be implicit semantics of the rules rather than something you
explicitly have to write
yeah exactly
iow, you should write eq(hp.begin_date, hp.first_installement.date)

alright that works, i'll have to think about how we could get this . syntax into chr 
well, i mean, not a special syntax that resolves values, just that the rules shouldnt ever mention the rdf:value thing at all
ah, yea; so i just need to make a small thing to do the translation from the chr version to the doc version w/ rdf:value
later maybe we'd rewrite the chr side to actually work internally over the rdf:value representation but probably don't want to do that now
ok well it was one of the things i was looking forward to here, but whatever works
i mean, it should be "resolved" in the place where youre actually applying the clpq constraint, for example
and the explainer output should be generated there as well
idk how it'd work out for unification in general, but i'd imagine it would just fine

also, probably "explainer output" should just mean annotating triples by sticking them in one-triple graphs and attaching properties to those graphs

so, if we're asserting/adding hp_contract number_of_installments 5,
it's coming from a constraint eq(hp_contract.number_of_installments, hp_contract.last_installment.index)
nvm
well, idk, in this case, if we're producing a new literal, i guess the properties should be attached to the value object

hp_contract number_of_installments [rdf:value 5;origin [a formula; contents "eq(hp_contract.number_of_installments, hp_contract.last_installment.index)"; 

or [a equality; op1 <the actual bnode that is hp_contract.number_of_installments>; op2 <the actual bnode that is hp_contract.last_installment.index>]

attaching them to the value object would probably be the easiest way, especially w/ chr as it is now, but i think that has
some limitations and we probably would want to be able to annotate whole triples

i suppose the explainer ui/page should allow following along some abstract-ish proof tree (of the search or rule firings or something) and along the constraints network, but i dont have a clear picture

i can try to work that out in some other parts of the codebase first, on some simple backchaining logic, and then we can see how it applies to chr, i already kinda started on this but was more concerned with other aspects

yea should definitely just generate a proof tree, probably wouldn't be too difficult to wrap each chr rule-head in something that will assert some representation of the rule-firing into the doc, and the links between each rule-firing (i.e. what body items were matched) will make the tree
but i'd maybe want to hold off on this until we've handled optimization enough to make it reasonable to actually use the solver and also made a special syntax for the rules 
ok
just wouldn't want to devote much more effort into expanding what the current chr solver can do if it might end up going to waste if we run into trouble w/ those two things and need to do a more major rewrite of the solver core
yeah and i'll be happier to work this out on a reasoning algo i fully understand and also to extend the doc system to actually allow it as i envision it first

but yea sounds about right, rules generate triples, and to annotate a triple you need a graph, so those proofs will go into graphs,
while constraints will get attached into the values
i would treat constraints as also being in the graph, i.e. an equation like X + Y = Z can be interpreted as an 3-ary relation +(X,Y,Z)

so the way i think of it now is, it's fine to use graphs for purposes of (vaguely) organizing stuff, for example, i could choose to store l:request and the template data in different graphs, just so that it's simpler to process/edit/visualize.
But beyond that, i'd reserve use of (non-default) graphs for situations when you need to say something about a triple, ie about a relation, as opposed to about an object.
Ie there is some semantics that we assign to the default graph, roughly something like "this is the world according to these documents and our rules", 
well, err, the distinction i'm trying to make is between graphs used to lump together triples of common purpose, and graphs in the sense of unique identifiers of individual triples, ie, a triple gets it's own graph so we can talk about it, and that graph is semantically included in the parent graph with something like <graph> includes <graph>. And in that sense, the fact that "hp_contract end_date _:bn1" deserves a triple-id so we can link a proof to it, while the fact that _:bn1 participates in some constraints can/should be stated in the default graph












*/

            a hp:hp_calculator_query ;

            hp:begin_date [
                    rdf:value "2019-10-10T00:00:00"^^xsd:dateTime
             ] ;
            hp:hp_contract [
                    a hp:hp_contract ;

                    hp:cash_price [
                            rdf:value 321321.27
                     ] ;
                    hp:contract_number [
                            rdf:value "xxxx"^^xsd:string
                     ] ;
                    hp:currency [
                            rdf:value "AUD"^^xsd:string
                     ] ;
                    hp:hp_contract_has_payment_type [
                            rdf:value hp:hp_contract_payment_type_advance
                     ] ;
                    hp:hp_installments [
                            rdf:value () ;
                            excel:template hp_ui:hp_installments
                     ] ;
                    hp:interest_rate [
                            rdf:value 5
                     ] ;
                    hp:number_of_installments [
                            rdf:value 30
                     ] ;

                    excel:template hp_ui:hp_contract
             ] ;

            excel:has_sheet_name "HP" ;
            excel:template hp_ui:hp_calculator_query

			/*the data you get in the request have everything they need to be displayable
ie sheet name and template, so the plugin displays from basically a filled-out version of this object?
yeah i think
*/
     ] .
